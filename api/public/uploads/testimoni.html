<!doctype html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>Gallery Testimoni</title>
    <style>
        :root{
            --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#06b6d4;
            --radius:10px; --glass: rgba(255,255,255,0.03);
        }
        *{box-sizing:border-box}
        body{
            margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue";
            background:linear-gradient(180deg,#071029 0%, #071827 60%); color:#e6eef6; -webkit-font-smoothing:antialiased;
            -webkit-touch-callout:none; -webkit-user-select:none; -ms-user-select:none; user-select:none;
        }
        header{
            display:flex; align-items:center; gap:16px; padding:14px 18px; backdrop-filter: blur(6px);
            background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-bottom:1px solid rgba(255,255,255,0.03);
            position:sticky; top:0; z-index:40;
        }
        header img.logo{height:44px; width:auto; border-radius:8px; background:var(--glass); padding:4px}
        .title{font-weight:700; letter-spacing:0.2px}
        nav{margin-left:auto; display:flex; gap:8px}
        .tab{
            appearance:none; border:0; background:transparent; color:var(--muted); padding:8px 12px; border-radius:8px;
            cursor:pointer; font-weight:600; transition:all .18s;
        }
        .tab.active{color:#022; background:var(--accent); box-shadow:0 6px 18px rgba(6,182,212,0.12)}
        main{padding:18px; max-width:1200px; margin:18px auto}
        .controls{display:flex; gap:12px; align-items:center; margin-bottom:12px}
        .search{
            flex:1; padding:10px 12px; border-radius:10px; background:var(--card); border:1px solid rgba(255,255,255,0.03);
            color:var(--muted); outline:none;
        }

        /* gallery grid */
        .grid{display:grid; gap:12px}
        /* mobile: 2 columns (two items per row) */
        @media (max-width:700px){ .grid{grid-template-columns: repeat(2, 1fr);} }
        @media (min-width:701px) and (max-width:1024px){ .grid{grid-template-columns: repeat(3, 1fr);} }
        @media (min-width:1025px){ .grid{grid-template-columns: repeat(5, 1fr);} }

        .card{
            background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
            border-radius:12px; padding:8px; display:flex; flex-direction:column; gap:8px; align-items:center;
            border:1px solid rgba(255,255,255,0.02);
        }
        .thumb{
            width:100%; aspect-ratio: 4/3; object-fit:cover; border-radius:8px; cursor:pointer;
            transition:transform .18s, box-shadow .18s; box-shadow: 0 4px 14px rgba(2,6,23,0.35);
        }
        .thumb:active{transform:scale(.995)}
        .meta{width:100%; display:flex; justify-content:space-between; font-size:12px; color:var(--muted); padding:0 4px}
        .date{font-size:12px}
        .play{
            position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); pointer-events:none;
            width:56px; height:56px; border-radius:50%; display:flex; align-items:center; justify-content:center;
            background:linear-gradient(90deg, rgba(0,0,0,0.5), rgba(0,0,0,0.35)); color:white;
        }

        /* modal / lightbox */
        .overlay{
            position:fixed; inset:0; display:none; place-items:center; background:rgba(2,6,23,0.75); z-index:90;
            padding:20px;
        }
        .overlay.show{display:grid}
        .viewer{ max-width:1100px; width:100%; max-height:90vh; background:rgba(0,0,0,0.55); border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:8px }
        .viewer img, .viewer video{ max-width:100%; max-height:76vh; border-radius:10px; margin:auto; display:block }
        .vmeta{display:flex; justify-content:space-between; color:var(--muted); font-size:13px; align-items:center}
        .closebtn{background:transparent; color:var(--muted); border:0; font-weight:700; cursor:pointer}
        .thumb-wrap{position:relative; width:100%}
        footer{padding:18px; color:var(--muted); text-align:center; font-size:13px}

        /* tiny helpers */
        .muted{color:var(--muted)}
        .badge{background:rgba(255,255,255,0.04); padding:6px 8px; border-radius:8px; font-size:12px}
        a.logo-link{display:flex; align-items:center; gap:10px; text-decoration:none; color:inherit}
        /* make images look small on purpose */
        .thumb{height:120px}
        @media (max-width:700px){ .thumb{height:110px} }
    </style>
</head>
<body>
    <header>
        <a href="#" class="logo-link" onclick="return false;">
            <img src="logobaru.jpg" alt="logo" class="logo">
            <div>
                <div class="title">Testimoni Gallery </div>
                <div style="font-size:12px;color:var(--muted)">OcinShop Bukti pembeli</div>
            </div>
        </a>

        <nav aria-label="Main menu">
            <button class="tab active" data-tab="testi">Testi</button>
            <button class="tab" data-tab="videos">Video</button>
            <button class="tab" data-tab="stok">Stok</button>
        </nav>
    </header>

    <main>
        <div class="controls">
            <input class="search" id="search" placeholder="search" />
            <div class="badge" id="count">—</div>
        </div>

        <section id="testi" class="panel">
            <div class="grid" id="testiGrid" aria-live="polite"></div>
        </section>

        <section id="videos" class="panel" style="display:none">
            <div class="grid" id="videoGrid"></div>
        </section>

        <section id="stok" class="panel" style="display:none">
            <div class="grid" id="stokGrid"></div>
        </section>
    </main>

    <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="viewer" role="document">
            <div style="display:flex;justify-content:space-between;align-items:center">
                <div class="vmeta" id="vmeta">
                    <div id="vtitle">Preview</div>
                    <div id="vdate" class="muted"></div>
                </div>
                <div>
                    <button class="closebtn" id="closeBtn" aria-label="Tutup">✕</button>
                </div>
            </div>
            <div id="vcontent" style="text-align:center"></div>
        </div>
    </div>
    <script>
        // Counts based on user request
        const TESTI_COUNT = 159; // testi0.jpg ... testi300.jpg
        const VIDEO_COUNT = 49;  // tvd0.mp4 ... tvd50.mp4
        const STOK_COUNT  = 9; // stok0.jpg ... stok100.jpg

        // container refs
        const testiGrid = document.getElementById('testiGrid');
        const videoGrid = document.getElementById('videoGrid');
        const stokGrid  = document.getElementById('stokGrid');
        const countEl   = document.getElementById('count');

        // utility: format date for each item (recent first)
        function formatDateFromIndex(i){
            const d = new Date();
            // spread dates across last TESTI_COUNT days; cap reasonable
            d.setDate(d.getDate() - i);
            return d.toISOString().slice(0,10);
        }

        // create an image card
        function makeImageCard(src, label, date){
            const fig = document.createElement('figure');
            fig.className = 'card';
            const wrap = document.createElement('div');
            wrap.className = 'thumb-wrap';
            const img = document.createElement('img');
            img.className = 'thumb';
            img.loading = 'lazy';
            img.src = src;
            img.alt = label;
            img.dataset.date = date;
            wrap.appendChild(img);
            fig.appendChild(wrap);

            const meta = document.createElement('div');
            meta.className = 'meta';
            const t = document.createElement('div'); t.textContent = label;
            t.style.fontSize='13px';
            const d = document.createElement('div'); d.className='date muted'; d.textContent = date;
            meta.appendChild(t); meta.appendChild(d);
            fig.appendChild(meta);

            // click => open viewer
            img.addEventListener('click', ()=> openViewer({type:'image', src, date, label}));
            return fig;
        }

        // create a video thumbnail card (load video on demand)
        function makeVideoCard(src, label, date){
            const fig = document.createElement('figure');
            fig.className = 'card';
            const wrap = document.createElement('div');
            wrap.className = 'thumb-wrap';
            // use poster as the first frame via video tag, but to keep light we try common thumbnail name patterns and fall back to a placeholder
            const img = document.createElement('img');
            img.className = 'thumb';
            img.loading = 'lazy';
            img.alt = label;
            img.dataset.date = date;
            wrap.appendChild(img);

            // try multiple candidate thumbnail URLs in order
            const candidates = [
                src.replace(/\.mp4$/i, '.jpg'),
                src.replace(/\.mp4$/i, '_thumb.jpg'),
                src.replace(/\.mp4$/i, '.png'),
            ];
            let idx = 0;
            const placeholder = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="640" height="360"><rect fill="%23071229" width="100%" height="100%"/><text x="50%" y="50%" fill="%23fff" font-size="22" text-anchor="middle" dy=".35em">Video</text></svg>';
            function tryNextThumb(){
                if(idx >= candidates.length){
                    img.onerror = null;
                    img.src = placeholder;
                    return;
                }
                img.onerror = function(){ idx++; tryNextThumb(); };
                img.src = candidates[idx];
            }
            tryNextThumb();

            const play = document.createElement('div');
            play.className='play';
            play.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>';
            wrap.appendChild(play);

            fig.appendChild(wrap);
            const meta = document.createElement('div');
            meta.className = 'meta';
            const t = document.createElement('div'); t.textContent = label; t.style.fontSize='13px';
            const d = document.createElement('div'); d.className='date muted'; d.textContent = date;
            meta.appendChild(t); meta.appendChild(d);
            fig.appendChild(meta);

            img.addEventListener('click', ()=> openViewer({type:'video', src, date, label}));
            play.addEventListener('click', ()=> openViewer({type:'video', src, date, label}));
            return fig;
        }

        // populate galleries lazily to avoid blocking; create fragments
        function populateTesti(){
            const frag = document.createDocumentFragment();
            for(let i=0;i<TESTI_COUNT;i++){
                const src = `testi${i}.jpg`;
                const date = formatDateFromIndex(i);
                const label = `Testi #${i}`;
                frag.appendChild(makeImageCard(src,label,date));
            }
            testiGrid.appendChild(frag);
            countEl.textContent = `${TESTI_COUNT} item`;
        }

        function populateVideos(){
            const frag = document.createDocumentFragment();
            for(let i=0;i<VIDEO_COUNT;i++){
                const src = `tvd${i}.mp4`;
                const date = formatDateFromIndex(i);
                const label = `Video #${i}`;
                frag.appendChild(makeVideoCard(src,label,date));
            }
            videoGrid.appendChild(frag);
        }

        function populateStok(){
            const frag = document.createDocumentFragment();
            for(let i=1;i<STOK_COUNT;i++){
                const src = `https://ocinshop.my.id/stok${i}.jpg`;
                const date = formatDateFromIndex(i);
                const label = `Stok #${i}`;
                frag.appendChild(makeImageCard(src,label,date));
            }
            stokGrid.appendChild(frag);
        }

        // viewer logic
        const overlay = document.getElementById('overlay');
        const vcontent = document.getElementById('vcontent');
        const vdate = document.getElementById('vdate');
        const vtitle = document.getElementById('vtitle');
        const closeBtn = document.getElementById('closeBtn');

        function openViewer({type, src, date, label}){
            vtitle.textContent = label || '';
            vdate.textContent = date || '';
            vcontent.innerHTML = '';
            overlay.classList.add('show');
            overlay.setAttribute('aria-hidden','false');

            if(type === 'image'){
                const img = document.createElement('img');
                img.src = src;
                img.alt = label;
                img.style.maxHeight = '82vh';
                img.style.cursor = 'zoom-out';
                vcontent.appendChild(img);
                // allow zoom/pinch inside viewer by enabling pointer events + not restricting scale here
                // clicking closes
                img.addEventListener('click', closeViewer);
            } else if(type === 'video'){
                const vid = document.createElement('video');
                vid.src = src;
                vid.controls = true;
                vid.autoplay = true;
                vid.playsInline = true;
                vid.style.maxHeight = '82vh';
                vcontent.appendChild(vid);
            }
            // trap focus lightly
            closeBtn.focus();
        }
        function closeViewer(){
            overlay.classList.remove('show');
            overlay.setAttribute('aria-hidden','true');
            vcontent.innerHTML = '';
        }
        closeBtn.addEventListener('click', closeViewer);
        overlay.addEventListener('click', (e)=> { if(e.target === overlay) closeViewer(); });
        document.addEventListener('keydown', (e)=> { if(e.key === 'Escape') closeViewer(); });

        // tabs
        document.querySelectorAll('.tab').forEach(btn=>{
            btn.addEventListener('click', ()=>{
                document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
                btn.classList.add('active');
                const tab = btn.dataset.tab;
                document.querySelectorAll('.panel').forEach(p=> p.style.display = 'none');
                document.getElementById(tab).style.display = '';
                // lazy populate when switching
                if(tab === 'videos' && videoGrid.children.length===0) populateVideos();
                if(tab === 'stok' && stokGrid.children.length===0) populateStok();
                if(tab === 'testi' && testiGrid.children.length===0) { populateTesti(); }
                // update count
                let c = 0;
                if(tab==='testi') c = TESTI_COUNT;
                if(tab==='videos') c = VIDEO_COUNT;
                if(tab==='stok') c = STOK_COUNT;
                countEl.textContent = c + ' item';
            });
        });

        // search filter by date or text
        const search = document.getElementById('search');
        search.addEventListener('input', ()=>{
            const q = search.value.trim().toLowerCase();
            const activePanel = document.querySelector('.tab.active').dataset.tab;
            const container = activePanel === 'testi' ? testiGrid : (activePanel === 'videos' ? videoGrid : stokGrid);
            if(!container) return;
            for(const card of container.children){
                const label = (card.querySelector('.meta div')?.textContent || '').toLowerCase();
                const date = (card.querySelector('.date')?.textContent || '').toLowerCase();
                const show = !q || label.includes(q) || date.includes(q);
                card.style.display = show ? '' : 'none';
            }
            const visible = Array.from(container.children).filter(c=>c.style.display!=='none').length;
            countEl.textContent = visible + ' item';
        });

        // initial population (testi only)
        populateTesti();

        // Accessibility note: user requested disabling zoom on page; meta viewport set with maximum-scale=1 and user-scalable=no.
        // Images are intentionally small thumbnails; clicking opens larger view.
    </script>
</body>
</html>



<!-- WA floating button -->
<style>
    .wa-fab {
        position: fixed;
        right: 16px;
        bottom: 16px;
        z-index: 99999;
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: linear-gradient(180deg,#20c65b,#12a34a);
        box-shadow: 0 8px 20px rgba(18,163,74,0.25), 0 2px 6px rgba(0,0,0,0.3);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: transform .12s ease, box-shadow .12s ease;
        border: 2px solid rgba(255,255,255,0.06);
    }
    .wa-fab:active { transform: scale(.97); }
    .wa-fab:hover { box-shadow: 0 10px 26px rgba(18,163,74,0.32); transform: translateY(-2px); }

    .wa-fab svg { width: 26px; height: 26px; display:block; fill: #fff; }

    /* subtle pulse to draw attention */
    @keyframes wa-pulse {
        0% { box-shadow: 0 0 0 0 rgba(34,197,94,0.32); }
        70% { box-shadow: 0 0 0 18px rgba(34,197,94,0); }
        100% { box-shadow: 0 0 0 0 rgba(34,197,94,0); }
    }
    .wa-fab.pulse { animation: wa-pulse 2.6s infinite; animation-delay: .5s; }
    /* hide on very small screens if needed */
    @media (max-width:360px){ .wa-fab{ right:12px; bottom:12px; width:52px; height:52px; } }
</style>

<a
    class="wa-fab pulse"
    id="waFab"
    href="https://wa.me/639094023904?text=Halo%20Admin%2C%20saya%20ingin%20bertanya%20mengenai%20produk."
    target="_blank"
    rel="noopener noreferrer"
    aria-label="Chat via WhatsApp"
    title="Chat admin via WhatsApp">
    <!-- WhatsApp SVG icon -->
    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M20.52 3.48A11.85 11.85 0 0012 0C5.37 0 .03 5.34.03 11.97c0 2.11.55 4.18 1.6 6.01L0 24l6.25-1.64a11.93 11.93 0 005.76 1.5c6.63 0 12-5.34 12-11.97 0-3.2-1.25-6.21-3.49-8.41zM12 21.1c-1.86 0-3.66-.5-5.24-1.44l-.37-.22-3.71.97.99-3.6-.24-.37A8.98 8.98 0 013.03 11.97C3.03 7.07 7.1 3 12 3c2.53 0 4.9.99 6.7 2.78A9.41 9.41 0 0121.7 12c0 5-4.07 9.1-9.7 9.1z"/>
        <path d="M17.53 14.34c-.28-.14-1.66-.82-1.92-.9-.26-.08-.45-.13-.64.14-.19.27-.74.9-.9 1.09-.16.19-.32.21-.6.07-.28-.14-1.18-.43-2.25-1.39-.83-.74-1.39-1.66-1.55-1.94-.16-.27-.02-.42.12-.55.12-.12.28-.31.42-.47.14-.16.19-.27.28-.45.09-.19.04-.35-.02-.49-.06-.14-.64-1.55-.88-2.12-.23-.56-.47-.48-.64-.49l-.55-.01c-.19 0-.5.07-.76.35-.26.28-1 1-1 2.43 0 1.42 1.03 2.79 1.17 2.98.15.19 2.03 3.1 4.92 4.35 2.89 1.25 2.89.83 3.41.78.52-.05 1.66-.67 1.9-1.32.24-.65.24-1.2.17-1.32-.07-.12-.26-.19-.54-.33z"/>
    </svg>
</a>

<script>
    (function(){
        const wa = document.getElementById('waFab');
        if(!wa) return;
        // Remove pulse after first visible interaction to avoid distraction
        function stopPulse(){
            wa.classList.remove('pulse');
            wa.removeEventListener('click', stopPulse);
            document.removeEventListener('touchstart', stopPulse);
        }
        wa.addEventListener('click', stopPulse, {once:true});
        document.addEventListener('touchstart', stopPulse, {once:true});

        // Optional: on desktop, open a small popup instead of new tab (fallback to target=_blank)
        wa.addEventListener('click', function(e){
            // prefer default anchor behavior; on desktop open whatsapp web in new tab (already target=_blank)
            // no-op here but kept for future enhancements
        });
    })();
</script>

<style>
    /* simple styles for sort control */
    .sort-select {
        appearance: none;
        border: 1px solid rgba(255,255,255,0.04);
        background: var(--card);
        color: var(--muted);
        padding: 8px 10px;
        border-radius: 10px;
        font-weight:600;
        cursor: pointer;
    }
    .controls { align-items:center; }
    @media (max-width:420px){
        .sort-select { padding:7px 8px; font-size:13px; }
    }
</style>

<script>
    (function(){
        // inject sort control into .controls
        const controls = document.querySelector('.controls');
        if(!controls) return;

        const select = document.createElement('select');
        select.className = 'sort-select';
        select.setAttribute('aria-label','Urutkan item');
        select.innerHTML = [
            {v:'date-desc', t:'Terbaru'},
            {v:'date-asc',  t:'Terlama'},
            {v:'label-asc', t:'A → Z'},
            {v:'label-desc',t:'Z → A'}
        ].map(o => `<option value="${o.v}">${o.t}</option>`).join('');
        // insert before count badge so it's near search
        const countBadge = document.getElementById('count');
        controls.insertBefore(select, countBadge);

        function getActiveContainer(){
            const active = document.querySelector('.tab.active');
            if(!active) return null;
            const tab = active.dataset.tab;
            if(tab === 'testi') return document.getElementById('testiGrid');
            if(tab === 'videos') return document.getElementById('videoGrid');
            if(tab === 'stok') return document.getElementById('stokGrid');
            return null;
        }

        function getMetaFromCard(card){
            const labelEl = card.querySelector('.meta div');
            const label = labelEl ? (labelEl.textContent || '') : '';
            const dateEl = card.querySelector('.date');
            const date = dateEl ? (dateEl.textContent || '') : (card.querySelector('img')?.dataset.date || '');
            return {label: label.trim(), date: date.trim()};
        }

        function sortContainer(container, mode){
            if(!container) return;
            const items = Array.from(container.children);
            // stable sort: map to [item, key]
            items.sort((a,b)=>{
                const ma = getMetaFromCard(a);
                const mb = getMetaFromCard(b);
                if(mode === 'date-desc' || mode === 'date-asc'){
                    // ISO date strings compare lexicographically; fallback to Date if needed
                    const da = ma.date || '';
                    const db = mb.date || '';
                    if(da === db) return 0;
                    if(mode === 'date-desc') return da > db ? -1 : 1;
                    return da < db ? -1 : 1;
                } else {
                    // label compare, case-insensitive
                    const la = ma.label.toLowerCase();
                    const lb = mb.label.toLowerCase();
                    if(la === lb) return 0;
                    if(mode === 'label-asc') return la < lb ? -1 : 1;
                    return la > lb ? -1 : 1;
                }
            });
            // re-append in new order (preserves display:hidden state)
            const frag = document.createDocumentFragment();
            items.forEach(i => frag.appendChild(i));
            container.appendChild(frag);
        }

        // handle select change
        select.addEventListener('change', ()=> {
            const mode = select.value;
            const container = getActiveContainer();
            // if videos/stok not populated yet, attempt to populate (mimic tab logic)
            if(container && container.children.length === 0){
                const tab = document.querySelector('.tab.active')?.dataset.tab;
                if(tab === 'videos') window.populateVideos?.();
                if(tab === 'stok') window.populateStok?.();
            }
            // small timeout to allow lazy populate to append items
            setTimeout(()=> sortContainer(getActiveContainer(), mode), 50);
        });

        // also re-sort when switching tabs to persist current selection
        document.querySelectorAll('.tab').forEach(btn=>{
            btn.addEventListener('click', ()=> {
                // wait a tick for tab content to show & lazy populate
                setTimeout(()=> {
                    sortContainer(getActiveContainer(), select.value);
                }, 60);
            });
        });

        // allow keyboard quick toggle: press "s" to focus sort select
        document.addEventListener('keydown', (e)=>{
            if(e.key === 's' && !/input|textarea/i.test(document.activeElement.tagName)){
                e.preventDefault();
                select.focus();
            }
        });
    })();
</script>

